import{_ as n,o as s,c as a,a as t}from"./app.2f80defe.js";const p={},e=t(`<p>\u6838\u5FC3\uFF1Aiframe\u9875\u9762\u52A0\u8F7D\u5B8C\u6210\u540E\u89E6\u53D1\u751F\u6210\u56FE\u7247\u903B\u8F91</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
  <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>posterDown<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iframeUrl<span class="token punctuation">&quot;</span></span>
  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 375px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 100%</span><span class="token punctuation">&quot;</span></span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u5F53\u9875\u9762\u6E32\u67D3\u5B8C\u6210\u65F6\u95F4</span>
window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;\u6E32\u67D3\u5B8C\u6210&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span>
<span class="token comment">//\u5982\u679C\u5B9E\u5728\u83B7\u53D6\u4E0D\u5230\u9875\u9762\u6E32\u67D3\u5B8C\u6210\u65F6\u95F4\u53EF\u4F7F\u7528\u5B9A\u65F6\u5668</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
    <span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u751F\u6210\u56FE\u7247</span>
      <span class="token function">drawImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span>
  <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">drawImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> iframeHtml <span class="token operator">=</span> posterDown<span class="token punctuation">.</span>value<span class="token punctuation">.</span>contentWindow
  <span class="token keyword">const</span> iframeScrollY <span class="token operator">=</span> iframeHtml<span class="token punctuation">.</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop
  <span class="token keyword">const</span> iframeScrollX <span class="token operator">=</span> iframeHtml<span class="token punctuation">.</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollLeft
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>iframeHtml<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">,</span> iframeScrollX<span class="token punctuation">,</span> <span class="token string">&#39;iframeHtml&#39;</span><span class="token punctuation">)</span>
  <span class="token function">html2canvas</span><span class="token punctuation">(</span>posterDown<span class="token punctuation">.</span>value<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">allowTaint</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// \u751F\u6210\u56FE\u7247\u7684\u6E05\u6670\u5EA6\uFF08\u8D8A\u5927\u8D8A\u6E05\u6670\uFF0C\u56FE\u7247\u5C31\u8D8A\u5927\uFF09  1  2  3  4  5  6  7  8  9  10</span>
    <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">&#39;#f5f5f5&#39;</span><span class="token punctuation">,</span> <span class="token comment">//\u6D77\u62A5\u7684\u80CC\u666F\u989C\u8272</span>
    <span class="token literal-property property">useCORS</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// \u5141\u8BB8\u8DE8\u57DF</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">375</span><span class="token punctuation">,</span> <span class="token comment">//\u751F\u6210\u6D77\u62A5\u7684</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> iframeHtml<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">,</span> <span class="token comment">// height: 200 //\u751F\u6210\u6D77\u62A5\u7684h    \u9ED8\u8BA4\u662Fpx</span>
    <span class="token literal-property property">windowHeight</span><span class="token operator">:</span> iframeHtml<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">,</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> iframeScrollX<span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> iframeScrollY
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> baseImg <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/png&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> save <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span>
    save<span class="token punctuation">.</span>href <span class="token operator">=</span> baseImg
    <span class="token comment">// \u4E0B\u8F7D\u7684\u540D\u5B57</span>
    save<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&#39;\u6587\u4EF6\u547D\u540D&#39;</span>
    save<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&#39;\u751F\u6210\u6210\u529F&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\uFF1A\u4E0D\u60F3\u5C55\u793Aiframe\u4F46\u5374\u9700\u8981\u4E0B\u8F7D\u56FE\u7247\u65F6\uFF0C\u53EF\u4EE5\u5C06iframe\u9875\u9762\u5C42\u7EA7\u8C03\u4F4E\uFF0C\u95F4\u63A5\u5B9E\u73B0\u9690\u85CF\u529F\u80FD\u3002</p>`,6),o=[e];function c(l,i){return s(),a("div",null,o)}var r=n(p,[["render",c],["__file","html2canvas\u5C06iframe\u9875\u9762\u751F\u6210\u56FE\u7247.html.vue"]]);export{r as default};
